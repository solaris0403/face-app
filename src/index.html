<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

	<link rel="stylesheet" href="./css/index.css">
	<link rel="stylesheet" href="./layui/css/layui.css">
	<link rel="stylesheet" href="./css/jquery-weui.min.css">
	<link rel="stylesheet" href="./css/weui.min.css">
	<title></title>
</head>

<body>
	<div class="header">
		<div class="weui-search-bar" id="searchBar">
			<form class="weui-search-bar__form">
				<div class="weui-search-bar__box">
					<i class="weui-icon-search"></i>
					<input type="search" class="weui-search-bar__input" id="searchInput" placeholder="搜索" required="">
					<a href="javascript:" class="weui-icon-clear" id="searchClear"></a>
				</div>
				<label class="weui-search-bar__label" id="searchText">
      <i class="weui-icon-search"></i>
      <span>搜索</span>
    </label>
			</form>
			<a href="javascript:" class="weui-search-bar__cancel-btn" id="searchCancel">取消</a>
		</div>
		<div class="wrapper wrapper01" id="retr">
			<div class="scroller">
				<ul class="clearfix">
					<li><a href="javascript:void(0)">金馆长</a></li>
					<li><a href="javascript:void(0)">张学友</a></li>
					<li><a href="javascript:void(0)">教皇</a></li>
					<li><a href="javascript:void(0)">尔康</a></li>
					<li><a href="javascript:void(0)">兵库北</a></li>
					<li><a href="javascript:void(0)">doge</a></li>
					<li><a href="javascript:void(0)">大眼萌</a></li>
					<li><a href="javascript:void(0)">斯巴达</a></li>
					<li><a href="javascript:void(0)">单挑</a></li>
					<li><a href="javascript:void(0)">皮皮虾</a></li>
					<li><a href="javascript:void(0)">修仙</a></li>
					<li><a href="javascript:void(0)">黑恶势力</a></li>
					<li><a href="javascript:void(0)">魔性小人</a></li>
					<li><a href="javascript:void(0)">枪</a></li>
					<li><a href="javascript:void(0)">剑</a></li>
					<li><a href="javascript:void(0)">拉条</a></li>
					<li><a href="javascript:void(0)">钱</a></li>
					<li><a href="javascript:void(0)">烟</a></li>
					<li><a href="javascript:void(0)">证</a></li>
					<li><a href="javascript:void(0)">饮料</a></li>
					<li><a href="javascript:void(0)">其他道具</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div class="space"></div>
	<div class="content">
		<div id="layui-face-container">
		</div>
	</div>
	<script src="./js/jquery.min.js"></script>
	<!-- <script type="text/javascript" src="/zx_local_res/jssdk/cordova.js"></script>
	<script type="text/javascript" src="/zx_local_res/jssdk/zx.js"></script> -->
	<script type="text/javascript" src="./js/flexible.js"></script>
	<script type="text/javascript" src="./js/iscroll.js"></script>
	<script type="text/javascript" src="./js/navbarscroll.js"></script>
	<script type="text/javascript" src="./layui/layui.js"></script>
	<script type="text/javascript" src="./js/jquery-weui.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			var height = $(".header").outerHeight(true);
			$(".space").height(height);
		});

		var json = '{"status":1,"data":{"list":[{"out_id":9698580,"image_url":"https://ws2.sinaimg.cn/bmiddle/9150e4e5ly1fhyv05ufisj202r02xa9z.jpg"},{"out_id":4314660,"image_url":"https://ws3.sinaimg.cn/bmiddle/9150e4e5ly1fg4mq8006eg202803c0sr.gif"},{"out_id":7859754,"image_url":"https://ws4.sinaimg.cn/bmiddle/6af89bc8gw1f8tvv68vlfj2026026jr7.jpg"},{"out_id":7886054,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8t8lj66cfj202d0250sh.jpg"},{"out_id":4440988,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8sv7xxhl8j2028028wee.jpg"},{"out_id":4976475,"image_url":"https://ws4.sinaimg.cn/bmiddle/6af89bc8gw1f8so315paag202s02sq30.gif"},{"out_id":1852530,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8shzfs2qnj202s02s0sl.jpg"},{"out_id":5403848,"image_url":"https://ws1.sinaimg.cn/bmiddle/6af89bc8gw1f8s8ztvcotg201w01wglg.gif"},{"out_id":4664935,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8s6pp1lctg204c02xwrp.gif"},{"out_id":7285126,"image_url":"https://ws1.sinaimg.cn/bmiddle/6af89bc8gw1f8s6w0621pg2028028aa8.gif"},{"out_id":8469095,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8rdcgrmscg200r00r0ah.gif"},{"out_id":7536262,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8r2cvniyyj201r0280rv.jpg"},{"out_id":9233952,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8qt9500vcj2031034745.jpg"},{"out_id":6936701,"image_url":"https://ws1.sinaimg.cn/bmiddle/6af89bc8gw1f8qphzhrmsj201g01o3ya.jpg"},{"out_id":7945922,"image_url":"https://ws1.sinaimg.cn/bmiddle/6af89bc8gw1f8qoccx8z0j203u05iq2v.jpg"},{"out_id":7673511,"image_url":"https://ws1.sinaimg.cn/bmiddle/6af89bc8gw1f8qm6evkiig202s02swei.gif"},{"out_id":9626401,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8qhym55osj205i051dfn.jpg"},{"out_id":7417249,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8q1c1c6pxj2038034mwx.jpg"},{"out_id":3351413,"image_url":"https://ws3.sinaimg.cn/bmiddle/9150e4e5gy1fpqq003e0gj203803cgld.jpg"},{"out_id":2072783,"image_url":"https://ws2.sinaimg.cn/bmiddle/9150e4e5ly1fo05ptbcktg20ci0ciws3.gif"},{"out_id":7005473,"image_url":"https://ws1.sinaimg.cn/bmiddle/9150e4e5ly1fmm5vgazohj202u02rq2q.jpg"},{"out_id":6410278,"image_url":"https://ws1.sinaimg.cn/bmiddle/9150e4e5ly1fjw84vnrnvj20k00k00tg.jpg"},{"out_id":4947606,"image_url":"https://ws3.sinaimg.cn/bmiddle/9150e4e5ly1fjkl3v3qacj20b40b4dgf.jpg"},{"out_id":3372256,"image_url":"https://ws1.sinaimg.cn/bmiddle/9150e4e5ly1fjbai425i3j204404lmwx.jpg"},{"out_id":2922790,"image_url":"https://ws3.sinaimg.cn/bmiddle/9150e4e5ly1fgm5wqqh0oj205i05b74c.jpg"},{"out_id":1624522,"image_url":"https://ws4.sinaimg.cn/bmiddle/9150e4e5ly1fg5imlo4awj202e02qdfx.jpg"},{"out_id":8557071,"image_url":"https://ws2.sinaimg.cn/bmiddle/9150e4e5ly1ffcz06sej5j201k01a0pb.jpg"},{"out_id":5051678,"image_url":"https://ws1.sinaimg.cn/bmiddle/9150e4e5ly1fdr0qyws1kj201e01dgld.jpg"},{"out_id":8533338,"image_url":"https://ws4.sinaimg.cn/bmiddle/9150e4e5ly1fd619qahuig202s02sgmv.gif"},{"out_id":6180841,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8u4wz2k6kj201y01p0sh.jpg"},{"out_id":1934734,"image_url":"https://ws2.sinaimg.cn/bmiddle/6af89bc8gw1f8u3vcb8fbj201b019gld.jpg"},{"out_id":3231000,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8t9lwnfr4g202i02iglt.gif"},{"out_id":5146205,"image_url":"https://ws4.sinaimg.cn/bmiddle/6af89bc8gw1f8t4xemogbj203903674c.jpg"},{"out_id":6379992,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8s91w2m3vj204304nt8n.jpg"},{"out_id":7720292,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8r4bvyv8wj20280233y9.jpg"},{"out_id":5340423,"image_url":"https://ws3.sinaimg.cn/bmiddle/6af89bc8gw1f8r2qoze01j205i03it8j.jpg"}],"more":1}}';

		var keyword;
		var option = function() {
			var flow = layui.flow;
			flow.load({
				elem: '#layui-face-container', //流加载容器
				isLazyimg: true,
				done: function(page, next) { //加载下一页
					var url = "https://www.doutula.com/api/search?mime=0&keyword=" + keyword + "&page=" + page;
					console.log("url:" + url);
					var obj = eval ("(" + json + ")");
					var status = obj["status"];//数据状态 1:正常 0:异常
					var data = obj["data"];
					var list = data["list"];//图片列表
					// var image = out_id / image_url
					var more = obj["more"];//表示下一页是否还有数据，0 就别再请求了。

					var lis = [];
					for (var i = 0; i < list.length; i++) {
						var out_id = list[i]["out_id"];
						var image_url = list[i]["image_url"];
						lis.push('<li><img lay-src=' + image_url + ' onclick="javascript:fun(this.src);"' + '></li>')
					}
					next(lis.join(''), more == 1); //假设总页数为 6


					// zx.requestLocalApi(function (result) {
					// 	console.log(JSON.stringify(result));
					// },"https://www.doutula.com/api/search?keyword=金馆长&mime=0&page=2", 0, null);


					//模拟插入
					// setTimeout(function() {
					// 	var lis = [];
					// 	for (var i = 0; i < 6; i++) {
					// 		var src = "http://s17.mogucdn.com/p2/161011/upload_279h87jbc9l0hkl54djjjh42dc7i1_800x480.jpg?v=' + ((page - 1) * 6 + i + 1) + '";
					// 		lis.push('<li><img lay-src=' + src + ' onclick="javascript:fun(this.src);"' + '></li>')
					// 	}
					// 	next(lis.join(''), more == 1); //假设总页数为 6
					// }, 500);
				}
			});
			//按屏加载图片
			flow.lazyimg({
				elem: '#layui-face-container img'
			});
		};

		var div = "<div id=\"layui-face-container\"></div>";
		var index = -1;
		function navClick(obj) {
			if (obj.index() != index) {
				keyword = obj.text();
				$("#layui-face-container").html(div);
				layui.use('flow', option);
				index = obj.index();
			}
		};

		function fun(url) {
			url = "detail.html?url=" + url;
			window.location.href = encodeURI(url);
		}

		$('.wrapper').navbarscroll({
				endClickScroll: function(obj) {
					navClick(obj);
				}
		});

		// var app = {
		// // Application Constructor
		// 	initialize: function() {
		// 			this.bindEvents();
		// 	},
		//
		// 	// Bind Event Listeners
		// 	//
		// 	// Bind any events that are required on startup. Common events are:
		// 	// 'load', 'deviceready', 'offline', and 'online'.
		// 	bindEvents: function() {
		// 			document.addEventListener('deviceready', this.onDeviceReady, false);
		// 	},
		//
		// 	// deviceready Event Handler
		// 	//
		// 	// The scope of 'this' is the event. In order to call the 'receivedEvent'
		// 	// function, we must explicitly call 'app.receivedEvent(...);'
		// 	onDeviceReady: function() {
		// 			// alert("onDeviceReady ua="+navigator.userAgent);
		// 			$('.wrapper').navbarscroll({
		// 					endClickScroll: function(obj) {
		// 						navClick(obj);
		// 					}
		// 			});
		// 		}
		// 	};
		// app.initialize();
	</script>
</body>

</html>
